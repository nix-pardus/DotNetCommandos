@using MudBlazor
@using UI.Models

<MudMenu Icon="@Icons.Material.Filled.ViewColumn" Dense="true" Variant="Variant.Text">
	<ActivatorContent>
		<MudIconButton Icon="@Icons.Material.Filled.ViewColumn" Color="Color.Primary" />
	</ActivatorContent>
	<ChildContent>
		<MudList T="string" Dense="true" Class="pa-2" Style="min-width: 220px;">
			@foreach (var column in Columns)
			{
				<MudListItem>
					<MudCheckBox T="bool" Value="@column.Visible"
								 ValueChanged="@(v => OnColumnVisibilityChanged(column.Key, v))"
								 Label="@column.Label" Color="Color.Primary" />
				</MudListItem>
			}
		</MudList>
	</ChildContent>
</MudMenu>

@code {
	[Parameter]
	public List<ColumnVisibilityItem> Columns { get; set; }

	[Parameter]
	public EventCallback<List<ColumnVisibilityItem>> VisibleColumnsChanged { get; set; }

	private async Task OnColumnVisibilityChanged(string columnKey, bool isVisible)
	{
		Columns.First(c => c.Key == columnKey).Visible = isVisible;
		await VisibleColumnsChanged.InvokeAsync(Columns);
	}


}
